@page "/admin/communities"

@inject CommunityAdminViewModel vm;

<iPath.Blazor.Componenents.Shared.IPathHeader Title="Community Administration">
    <ActionContent>
        <MudFab StartIcon="@Icons.Material.Filled.Add" Size="Size.Small" OnClick="vm.Create" />
    </ActionContent>
</iPath.Blazor.Componenents.Shared.IPathHeader>


<MudGrid>
    <MudItem xs="12" sm="8">

        <MudDataGrid T="CommunityListDto" ServerData="vm.GetListAsync"
                     RowClick="@(async args => await vm.SetSelectedItem(args.Item))"
                     RowStyleFunc="vm.SelectedRowStyle"
                     Dense>
            <Columns>
                <PropertyColumn Property="x => x.Name" />
            </Columns>
            <PagerContent>
                <MudDataGridPager T="CommunityListDto" />
            </PagerContent>
        </MudDataGrid>
    </MudItem>
    <MudItem xs="12" sm="4">
        @if (vm.SelectedCommunity is not null)
        {
            <MudText Typo="Typo.h5">@vm.SelectedCommunity.Name</MudText>
            <p><b>Base URL</b>: @vm.SelectedCommunity.BaseUrl</p>
            <p class="py-2">
                @((MarkupString) vm.SelectedCommunity.Description)
            </p>
            <MudDivider Class="my-2" />
            <MudText Typo="Typo.h6">Groups</MudText>
            @foreach (var g in vm.SelectedCommunity.Groups)
            {
                <p>@g.Name</p>
            }            
            <MudDivider Class="my-2" />
            <MudButton Size="Size.Small" Variant="Variant.Filled" Color="Color.Primary" StartIcon="@Icons.Material.Filled.Edit" OnClick="vm.Edit">Edit</MudButton>
        } 
    </MudItem>
</MudGrid>
